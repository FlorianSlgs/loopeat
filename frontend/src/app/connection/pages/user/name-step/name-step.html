<!-- name-step.html -->
<app-header [isPro]="isPro()"></app-header>

<div class="flex flex-col items-center justify-center text-center space-y-6 p-4">
  <!-- Titre -->
  <div>
    <h2 class="text-2xl font-semibold text-gray-900">
      @if (isPro()) {
        Quel est le nom de votre établissement ?
      } @else {
        Quel est votre nom ?
      }
    </h2>
  </div>

  <!-- Formulaire -->
  <form [formGroup]="nameForm" class="w-full max-w-md space-y-4">
    @if (isPro()) {
      <!-- Nom de l'établissement -->
      <div>
        <input
          type="text"
          formControlName="name"
          placeholder="Nom de l'établissement"
          class="w-full px-4 py-3 bg-gray-100 border-0 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-900 transition-all"
          [class.border-red-500]="isFieldInvalid('name')"
          [class.ring-2]="isFieldInvalid('name')"
          [class.ring-red-500]="isFieldInvalid('name')"
        />
        @if (isFieldInvalid('name')) {
          <p class="text-red-500 text-sm mt-1 text-left">
            Veuillez saisir un nom d'établissement valide (minimum 2 caractères).
          </p>
        }
      </div>
    } @else {
      <!-- Prénom -->
      <div>
        <input
          type="text"
          formControlName="firstName"
          placeholder="Prénom"
          class="w-full px-4 py-3 bg-gray-100 border-0 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-900 transition-all"
          [class.border-red-500]="isFieldInvalid('firstName')"
          [class.ring-2]="isFieldInvalid('firstName')"
          [class.ring-red-500]="isFieldInvalid('firstName')"
        />
        @if (isFieldInvalid('firstName')) {
          <p class="text-red-500 text-sm mt-1 text-left">
            Veuillez saisir un prénom valide (minimum 2 caractères).
          </p>
        }
      </div>

      <!-- Nom -->
      <div>
        <input
          type="text"
          formControlName="lastName"
          placeholder="Nom"
          class="w-full px-4 py-3 bg-gray-100 border-0 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-900 transition-all"
          [class.border-red-500]="isFieldInvalid('lastName')"
          [class.ring-2]="isFieldInvalid('lastName')"
          [class.ring-red-500]="isFieldInvalid('lastName')"
        />
        @if (isFieldInvalid('lastName')) {
          <p class="text-red-500 text-sm mt-1 text-left">
            Veuillez saisir un nom valide (minimum 2 caractères).
          </p>
        }
      </div>
    }

    <!-- Message d'erreur serveur -->
    @if (errorMessage()) {
      <p class="text-red-500 text-sm mt-2">
        {{ errorMessage() }}
      </p>
    }
  </form>

  <!-- Navigation -->
  <div class="flex justify-between items-center w-full max-w-md mt-8">
    <button
      type="button"
      class="flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition disabled:opacity-50 hover:curser-pointer"
      [disabled]="isSubmitting()"
      (click)="goBack()"
    >
      <span class="text-2xl mr-1">←</span> Retour
    </button>

    <button
      type="button"
      class="flex items-center px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition disabled:bg-gray-400 disabled:cursor-not-allowed hover:curser-pointer"
      (click)="goNext()"
      [disabled]="isSubmitting()"
    >
      {{ isSubmitting() ? 'Traitement...' : 'Suivant' }} 
      <span class="text-2xl ml-1">→</span>
    </button>
  </div>
</div>